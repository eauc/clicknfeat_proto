<div ng-controller="chatBoxCtrl">
  <div ng-show="game.id">
    <button style="
            width: 50px;
            height: 2em;
            "
            ng-click="game.rollDice(1)">1d6</button>
    <button style="
            width: 50px;
            height: 2em;
            "
            ng-click="game.rollDice(2)">2d6</button>
    <button style="
            width: 50px;
            height: 2em;
            "
            ng-click="game.rollDice(3)">3d6</button>
    <button style="
            width: 50px;
            height: 2em;
            "
            ng-click="game.rollDice(4)">4d6</button>
    <button style="
            width: 50px;
            height: 2em;
            "
            ng-click="game.rollDice(5)">5d6</button>
    <button style="
            width: 50px;
            height: 2em;
            "
            ng-click="game.rollDice(1, 3)">1d3</button>
    <form style="margin:0;"
          ng-submit="doSendMessage()">
      <input style="width:80%;"
             ng-model="chat_msg"
             placeholder="Chat msg..."
             ng-keydown="stopKeyPropagation($event)"
             ng-keypress="stopKeyPropagation($event)"
             />
      <button style="width:15%;"
              type="submit">Send</button>
    </form>
  </div>
  <div ng-repeat="cmd in showMsgCommands(game.new_commands).reverse()">
    <span style="color:#00f;"
          ng-style="{
          color: cmd.user.id === user.id ? '#33F' : '#F3F'
          }"
          >{{cmd.user}}</span>
    <span style="color:#0ff;">[{{cmd.msg_type}}]</span>
    {{cmd.msg_text}}
    <span style="color:#00f;"
          ng-if="cmd.msg_type === 'dice'">
      = {{cmd.msg_total}}
    </span>
  </div>
  <div ng-repeat="cmd in showMsgCommands(game.commands).reverse()"
       ng-style="{
       'background-color': $index === 0 ? '#0F0' : 'none'
       }"
       >
    &#8594;
    <span style="color:#00f;"
          ng-style="{
          color: cmd.user.id === user.id ? '#33F' : '#F3F',
          }"
          >[{{cmd.user}}]</span>
    <span style="color:#0AA;">({{cmd.msg_type}})</span>
    {{cmd.msg_text}}
    <span ng-if="cmd.msg_type === 'dice'">
      = {{cmd.msg_total}}
    </span>
  </div>
</div>
